<!DOCTYPE html>
<html lang="en" class="astro-EKSNFE3U">
  <head>
    <!-- Global Metadata --><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Astro v1.4.6">

<!-- Primary Meta Tags -->
<title>Qt : QMultiHash and QHashIterator</title>
<meta name="title" content="Qt : QMultiHash and QHashIterator">
<meta name="description">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://vhanda.in/blog/2010/06/qt-qmultihash-and-qhashiterator/">
<meta property="og:title" content="Qt : QMultiHash and QHashIterator">
<meta property="og:description">
<meta property="og:image" content="https://vhanda.in/placeholder-social.jpg">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://vhanda.in/blog/2010/06/qt-qmultihash-and-qhashiterator/">
<meta property="twitter:title" content="Qt : QMultiHash and QHashIterator">
<meta property="twitter:description">
<meta property="twitter:image" content="https://vhanda.in/placeholder-social.jpg">

    
  <link rel="stylesheet" href="/assets/5d57c98f.7e8ebc48.css" />
<link rel="stylesheet" href="/assets/7b6f844a.6aba9791.css" /></head>

  <body class="astro-EKSNFE3U">
    <header class="astro-FR777CPJ">
  <h2 class="astro-FR777CPJ">
    Vishesh Handa&#39;s personal website
  </h2>
  <nav class="astro-FR777CPJ">
    <a href="/" class="astro-FR777CPJ astro-HA6FOUVL">
  Home
</a>

    <a href="/blog" class="astro-FR777CPJ astro-HA6FOUVL">
  Blog
</a>

    <a href="/about" class="astro-FR777CPJ astro-HA6FOUVL">
  About
</a>

    <a href="https://twitter.com/visheshhanda" class="astro-FR777CPJ astro-HA6FOUVL" target="_blank">
  Twitter
</a>

    <a href="https://github.com/vhanda" class="astro-FR777CPJ astro-HA6FOUVL" target="_blank">
  GitHub
</a>

  </nav>
</header>

    <main class="astro-EKSNFE3U">
      <article class="astro-EKSNFE3U">
        
        <h1 class="title astro-EKSNFE3U">Qt : QMultiHash and QHashIterator</h1>
        <time class="astro-EKSNFE3U">2010-06-23T22:02:10Z</time>
        
        <hr class="astro-EKSNFE3U">
        <p>Qt’s implementation of QMultiHash iterator is a little non-intuitive.</p>
<p>One would expect a multi hash to be implemented as <code>&#x3C;uniqueKey, list of values></code> pairs, where the list of values could even be a set. But QMultiHash is derived from QHash, and it stores the same key multiple times. It stores a number of <em>unique</em> <strong><code>key, value</code></strong> pairs.</p>
<p>This can cause some amount of confusion while iterating over a multi-hash with a QHashIterator.</p>
<p>Here is what I’d been doing (in-correct code)</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #FFA657">QHashIterator</span><span style="color: #C9D1D9">&#x3C;</span><span style="color: #FFA657">Key</span><span style="color: #C9D1D9">, </span><span style="color: #FFA657">Value</span><span style="color: #C9D1D9">> </span><span style="color: #D2A8FF">it</span><span style="color: #C9D1D9">( </span><span style="color: #FFA657">multiHash</span><span style="color: #C9D1D9"> );</span></span>
<span class="line"><span style="color: #FF7B72">while</span><span style="color: #C9D1D9">( it.</span><span style="color: #D2A8FF">hasNext</span><span style="color: #C9D1D9">() ) {</span></span>
<span class="line"><span style="color: #C9D1D9">    it.</span><span style="color: #D2A8FF">next</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">    QList</span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9">Value</span><span style="color: #FF7B72">></span><span style="color: #C9D1D9"> values </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> multiHash.</span><span style="color: #D2A8FF">values</span><span style="color: #C9D1D9">( it.</span><span style="color: #D2A8FF">key</span><span style="color: #C9D1D9">() );</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #D2A8FF">foreach</span><span style="color: #C9D1D9">( </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> Value </span><span style="color: #FF7B72">&#x26;</span><span style="color: #C9D1D9">amp; v, values ) {</span></span>
<span class="line"><span style="color: #8B949E">        // Do whatever with v</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span></code></pre>
<p>This resulted in the same key being iterated a number of times, which isn’t what I wanted.</p>
<p>This was the correct way of doing it -</p>
<pre is:raw="" class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">QList</span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9">Key</span><span style="color: #FF7B72">></span><span style="color: #C9D1D9"> keys </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> multiHash.</span><span style="color: #D2A8FF">uniqueKeys</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #D2A8FF">foreach</span><span style="color: #C9D1D9">( </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> Key </span><span style="color: #FF7B72">&#x26;</span><span style="color: #C9D1D9">amp; k, keys ) {</span></span>
<span class="line"><span style="color: #C9D1D9">    QList</span><span style="color: #FF7B72">&#x3C;</span><span style="color: #C9D1D9">Value</span><span style="color: #FF7B72">></span><span style="color: #C9D1D9"> values </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> multiHash.</span><span style="color: #D2A8FF">values</span><span style="color: #C9D1D9">( it.</span><span style="color: #D2A8FF">key</span><span style="color: #C9D1D9">() );</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #D2A8FF">foreach</span><span style="color: #C9D1D9">( </span><span style="color: #FF7B72">const</span><span style="color: #C9D1D9"> Value </span><span style="color: #FF7B72">&#x26;</span><span style="color: #C9D1D9">amp; v, values ) {</span></span>
<span class="line"><span style="color: #8B949E">        // Do whatever with v</span></span>
<span class="line"><span style="color: #C9D1D9">    }</span></span>
<span class="line"><span style="color: #C9D1D9">}</span></span>
<span class="line"><span style="color: #C9D1D9">```cpp</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">This was rather obvious once I understood the way it stores a QMultiHash.</span></span></code></pre>
      </article>
    </main>
    <footer class="astro-OCYQ4NHN">
  &copy; 2022 Vishesh Handa. <a href="http://creativecommons.org/licenses/by-nc/4.0/" class="astro-OCYQ4NHN">Creative Commons 4.0</a>.
</footer>

  </body></html>